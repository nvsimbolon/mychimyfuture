shiny::runApp()
runApp()
runApp()
leaflet_dat2 <- dat %>%
group_by(`Geographic Cluster Name`) %>%
select(`Geographic Cluster Name`, !!'income', geometry) %>%
mutate(label = paste0(`Geographic Cluster Name`, ": ", 'income')) %>%
distinct() %>%
ungroup() %>%
st_as_sf()
library(shiny)
library(tidyverse)
library(skimr)
library(sf)
library(leaflet)
library(RColorBrewer)
merged_dat <- read_csv('Merged_Dataset.csv')
map_dat <- read_sf("https://raw.githubusercontent.com/thisisdaryn/data/master/geo/chicago/Comm_Areas.geojson") %>%
rename(community_area = community) %>%
mutate(
community_area = toupper(community_area),
community_area = case_when(
community_area == 'NEW CITY' ~ 'Back of the Yards',
community_area %in% c('DOUGLAS', 'GRAND BOULEVARD', 'OAKLAND') ~ 'Bronzeville/South Lakefront',
community_area %in% c('WEST GARFIELD PARK', 'EAST GARFIELD PARK') ~ 'GARFIELD PARK',
community_area == 'SOUTH LAWNDALE' ~ 'Little Village',
TRUE ~ community_area
))
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)))
leaflet_dat2 <- dat %>%
group_by(`Geographic Cluster Name`) %>%
select(`Geographic Cluster Name`, !!'income', geometry) %>%
mutate(label = paste0(`Geographic Cluster Name`, ": ", 'income')) %>%
distinct() %>%
ungroup() %>%
st_as_sf()
View(leaflet_dat2)
bins <- quantile(leaflet_dat2[['income']], probs = c(0, 0.25, 0.5, 0.75, 1))
leaflet_dat2[['income']]
pal <- colorBin("YlOrRd", domain = leaflet_dat2[['income']], bins = bins)
leaflet() %>%
setView(lng = -87.69, lat = 41.87, zoom = 10) %>%
addProviderTiles(
"OpenStreetMap",
group = "OpenStreetMap"
) %>%
addProviderTiles(
"CartoDB.Positron",
group = "CartoDB.Positron"
) %>%
addPolygons(
data = leaflet_dat2,
fillColor= ~pal(!!'income'),
fillOpacity = 0.2,
color = "grey",
weight = 1.5,
label = leaflet_dat2$label
) %>%
addScaleBar("bottomleft") %>%
addLegend(
pal = pal,
values = get('income', leaflet_dat2),
opacity = 0.7,
title = 'income',
position = "topright"
)
leaflet() %>%
setView(lng = -87.69, lat = 41.87, zoom = 10) %>%
addProviderTiles(
"OpenStreetMap",
group = "OpenStreetMap"
) %>%
addProviderTiles(
"CartoDB.Positron",
group = "CartoDB.Positron"
) %>%
addPolygons(
data = leaflet_dat2,
fillColor= ~get('income', leaflet_dat2),
fillOpacity = 0.2,
color = "grey",
weight = 1.5,
label = leaflet_dat2$label
) %>%
addScaleBar("bottomleft") %>%
addLegend(
pal = pal,
values = get('income', leaflet_dat2),
opacity = 0.7,
title = 'income',
position = "topright"
)
runApp()
runApp()
dat %>%
select_if(is.numeric) %>%
names()
merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`))) %>%
mutate_at(vars(matches("%")), ~as.numeric(sub("%", "", .))/100))
merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`))) %>%
mutate_at(vars(matches("%")), ~as.numeric(sub("%", "", .))/100)
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`))) %>%
mutate_at(vars(matches("%")), ~as.numeric(sub("%", "", .))/100)
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(matches("%")), ~as.numeric(sub("%", "", .))/100)
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(contains("%")), ~as.numeric(sub("%", "", .))/100))
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(contains("%")), ~as.numeric(sub("%", "", .))/100)
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(contains("%")), ~as.numeric(sub("%", "", .))/100) %>%
mutate_if(is.character, ~as.numeric(sub("%", "", .))/100))
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(contains("%")), ~as.numeric(sub("%", "", .))/100) %>%
mutate_if(is.character, ~as.numeric(sub("%", "", .))/100)
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(matches("[%$,]")), ~as.numeric(gsub("[%$,]", "", .))/100)
skimr::skim_without_charts(dat)
merged_dat <- read_csv('Merged_Dataset.csv')
map_dat <- read_sf("https://raw.githubusercontent.com/thisisdaryn/data/master/geo/chicago/Comm_Areas.geojson") %>%
rename(community_area = community) %>%
mutate(
community_area = toupper(community_area),
community_area = case_when(
community_area == 'NEW CITY' ~ 'Back of the Yards',
community_area %in% c('DOUGLAS', 'GRAND BOULEVARD', 'OAKLAND') ~ 'Bronzeville/South Lakefront',
community_area %in% c('WEST GARFIELD PARK', 'EAST GARFIELD PARK') ~ 'GARFIELD PARK',
community_area == 'SOUTH LAWNDALE' ~ 'Little Village',
TRUE ~ community_area
))
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`))
skimr::skim_without_charts(dat)
View(merged_dat)
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(numeric_cols), ~as.numeric(gsub("[^0-9.-]", "", .)))
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(dat), ~as.numeric(gsub("[^0-9.-]", "", .)))
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(merged_dat), ~as.numeric(gsub("[^0-9.-]", "", .)))
merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(contains("%")), ~as.numeric(sub("%", "", .))/100)
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate(across(where(is.character), ~ parse_number(.)))
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(contains("Percentage") | contains("Per Capita Income")),
~as.numeric(sub("%|\\$|,", "", .))/100)
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(contains("Percent") | contains("Per Capita Income")),
~as.numeric(sub("%|\\$|,", "", .))/100)
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(contains("Percent") | contains("Unemployment Rate")),
~as.numeric(sub("%|\\$|,", "", .))/100)
dat %>%
select_if(is.numeric) %>%
select(-`...1`, -No.)
dat %>%
select_if(is.numeric) %>%
select(-`...1`, -No.)
names()
dat %>%
select_if(is.numeric)
dat %>%
select_if(is.numeric) %>%
select(-`...1`, -No.) %>%
names()
runApp()
dat %>%
clean_names() %>%
rename_all(~str_to_title(.))
dat %>%
janitor::clean_names() %>%
rename_all(~str_to_title(.))
runApp()
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(contains("Percent") | contains("Unemployment Rate")),
~as.numeric(sub("%|\\$|,", "", .))/100) %>%
janitor::clean_names() %>%
rename_all(~str_to_title(.)) %>%
rename_all(~str_replace_all(., "_", " "))
runApp()
runApp()
runApp()
runApp()
map_dat <- read_sf("https://raw.githubusercontent.com/thisisdaryn/data/master/geo/chicago/Comm_Areas.geojson") %>%
rename(community_area = community) %>%
mutate(
community_area = toupper(community_area),
community_area = case_when(
community_area == 'NEW CITY' ~ 'Back of the Yards',
community_area %in% c('DOUGLAS', 'GRAND BOULEVARD', 'OAKLAND') ~ 'Bronzeville/South Lakefront',
community_area %in% c('WEST GARFIELD PARK', 'EAST GARFIELD PARK') ~ 'GARFIELD PARK',
community_area == 'SOUTH LAWNDALE' ~ 'Little Village',
TRUE ~ community_area
))
merged_dat <- read_csv('Merged_Dataset.csv')
map_dat <- read_sf("https://raw.githubusercontent.com/thisisdaryn/data/master/geo/chicago/Comm_Areas.geojson") %>%
rename(community_area = community) %>%
mutate(
community_area = toupper(community_area),
community_area = case_when(
community_area == 'NEW CITY' ~ 'Back of the Yards',
community_area %in% c('DOUGLAS', 'GRAND BOULEVARD', 'OAKLAND') ~ 'Bronzeville/South Lakefront',
community_area %in% c('WEST GARFIELD PARK', 'EAST GARFIELD PARK') ~ 'GARFIELD PARK',
community_area == 'SOUTH LAWNDALE' ~ 'Little Village',
TRUE ~ community_area
))
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(contains("Percent") | contains("Unemployment Rate")),
~as.numeric(sub("%|\\$|,", "", .))/100) %>%
janitor::clean_names() %>%
rename_all(~str_to_title(.)) %>%
rename_all(~str_replace_all(., "_", " "))
# combined data
dat <- merged_dat %>%
left_join(map_dat, by = c('Geographic Cluster Name' = 'community_area'), multiple = 'all') %>%
mutate(
`Geographic Cluster Name` = tools::toTitleCase(tolower(`Geographic Cluster Name`)),
`Per Capita Income` = parse_number(`Per Capita Income`)) %>%
mutate_at(vars(contains("Percent") | contains("Unemployment Rate")),
~as.numeric(sub("%|\\$|,", "", .))/100) %>%
janitor::clean_names() %>%
rename_all(~ str_to_title(str_replace_all(., "_", " ")))
runApp()
runApp()
runApp()
